 var models = require('../models/models.js');
 
 // Autoload - factoriza el código si ruta incluye :quizId
 exports.load = function(req, res, next, quizId) {
   models.Quiz.findById(quizId).then(
     function(quiz) {
       if (quiz) {
         req.quiz = quiz;
         next();

      } else{next(new Error('No existe quizId=' + quizId))}
     }

  ).catch(function(error){next(error)});
 };
 
 // GET /quizes
 @@ -27,14 +27,14 @@ exports.index = function(req, res) {
       order: 'pregunta ASC'
     } 
   ).then(function(quizes){
    res.render('quizes/index.ejs',{quizes: quizes, search: inputValueSearch, errors: []});
  }).catch(function(error){next(error)});
 };
 
 
 // GET /quizes/:id
 exports.show = function(req, res) {
  res.render('quizes/show', { quiz: req.quiz, errors: []});
 };
 
 // GET /quizes/:id/answer
 @@ -43,7 +43,7 @@ exports.answer = function(req, res) {
   if (req.query.respuesta === req.quiz.respuesta) {
     resultado = 'Correcto';
   }
  res.render('quizes/answer', {quiz: req.quiz, respuesta: resultado, errors: []});
 };
 
 // GET /quizes/new
 @@ -52,7 +52,7 @@ exports.new = function(req, res) {
     {pregunta: "Pregunta", respuesta: "Respuesta"}
   );
 
 res.render('quizes/new', {quiz: quiz, errors: []});
 };
 
 // POST /quizes/create
 exports.create = function(req, res) {
   var quiz = models.Quiz.build( req.body.quiz );
 
 
 // guarda en DB los campos pregunta y respuesta de quiz

  quiz
  .validate()
  .then(
    function(err){
      if (err) {
        res.render('quizes/new', {quiz: quiz, errors: err.errors});
      } else {
        quiz // save: guarda en DB campos pregunta y respuesta de quiz
        .save({fields: ["pregunta", "respuesta"]})
        .then( function(){ res.redirect('/quizes')}) 
      }      // res.redirect: Redirección HTTP a lista de preguntas
   }
 );
 };
